<div class="row mb-2">
  <form class="card-body" [formGroup]="searchForm">
    <div class="col-md-6">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Search by Name" id="filter" formControlName="filter">
        <!-- Select with placeholder -->
        <select class="form-control" formControlName="categoryId">
          <option value="-1" selected >All categories</option>
          <option *ngFor="let category of categories" [value]="category.id">
            {{ category.nameEn }}
          </option>
        </select>
        
        <div class="input-group-append">
          <button class="btn btn-info" type="button" id="searchButton" (click)="searchProducts()">Search</button>
        </div>
      </div>
    </div>
  </form>
</div>

<!-- <div class="card">
  <form class="card-body" [formGroup]="searchForm">
    <div class="flex gap-4">
      <div class="w-1/2">
        <label for="filter" class="block text-sm">Name:</label>
        <input type="text" class="form-control w-full" id="filter" formControlName="filter">
      </div>

      <div class="w-1/2">
        <label for="categoryId" class="block text-sm">Category:</label>
        <select class="form-control w-full" formControlName="categoryId">
          <option [value]="-1">All</option>
          <option *ngFor="let category of categories" [value]="category.id">
            {{ category.nameEn }}
          </option>
        </select>
      </div>
      
      <div class="w-auto self-end">
        <button type="button" class="btn btn-secondary" (click)="searchProducts()">Search</button>
      </div>
    </div>
  </form>
</div> -->


<div class="d-flex flex-row-reverse">
  <button *ngIf="canCreate" class="btn btn-primary mb-2" (click)="addProduct()">+ New Product</button>
</div>

<h2>Products List</h2>
<ngx-datatable class="material"
  [rows]="(products$ | async)?.items || []"
  [count]="(products$ | async)?.totalCount || 0"
  [columnMode]="'force'"
  [headerHeight]="50"
  [footerHeight]="50"
  [rowHeight]="50"
  [limit]="5">
  
  <ngx-datatable-column name="Name Arabic" prop="nameAr">
    <ng-template let-row="row" ngx-datatable-cell-template>
      {{ row.nameAr }}
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Name English" prop="nameEn">
    <ng-template let-row="row" ngx-datatable-cell-template>
      {{ row.nameEn }}
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column name="Category English" prop="categoryNameEn">
    <ng-template let-row="row" ngx-datatable-cell-template>
      {{ row.categoryNameEn }}
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column *ngIf="canShowDetails || canDelete || canEdit" name="Actions" [sortable]="false"   [headerClass]="'text-center'"  [cellClass]="'text-center'"  >
    <ng-template let-row="row" ngx-datatable-cell-template>
      <button *ngIf="canShowDetails" class="btn btn-info btn-sm" (click)="viewProductDetails(row.id)">Details</button>
      <button *ngIf="canEdit" class="btn btn-warning btn-sm mx-2" (click)="editProduct(row.id)">Edit</button>
      <button *ngIf="canDelete" class="btn btn-danger btn-sm" (click)="deleteProduct(row.id)">Delete</button>
    </ng-template>
  </ngx-datatable-column>

</ngx-datatable>
